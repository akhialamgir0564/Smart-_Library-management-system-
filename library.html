<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Smart Library Management System</title>
<style>
:root{
    --primary:#4f46e5;
    --secondary:#22c55e;
    --danger:#ef4444;
    --bg:#f1f5f9;
    --card:#ffffff;
    --hover:#4338ca;
    --text:#1e293b;
}
body{
    font-family: "Segoe UI", Arial;
    margin:0;
    padding:20px;
    min-height:100vh;
    background: linear-gradient(135deg,#fff1f2,#ffe4e6,#fdf2f8);
}
h1{
    text-align:center;
    color:#831843;
    margin-bottom:30px;
    font-weight:700;
}
section{
    background:var(--card);
    padding:20px;
    margin-bottom:25px;
    border-radius:10px;
    box-shadow:0 8px 20px rgba(0,0,0,0.08);
}
h2{
    color:#1e293b;
    margin-bottom:10px;
}
input{
    width:100%;
    padding:10px;
    margin:8px 0;
    border:1px solid #cbd5f5;
    border-radius:6px;
    font-size:14px;
}
button{
    padding:10px;
    border:none;
    border-radius:6px;
    font-size:14px;
    cursor:pointer;
    color:white;
    margin-top:5px;
    transition: 0.3s;
    box-shadow:0 3px 8px rgba(0,0,0,0.15);
}
button:hover{
    opacity:0.9;
    transform: translateY(-2px);
}
.add-btn{ background:var(--primary); }
.search-btn{ background:#0ea5e9; }
.issue-btn{ background:var(--secondary); }
.delete-btn{ background:var(--danger); }
.report-btn{ background:#6366f1; }
.analytics-btn{ background:#14b8a6; }

table{
    width:100%;
    border-collapse:collapse;
    margin-top:15px;
}
th, td{
    padding:12px;
    text-align:center;
    border-bottom:1px solid #e5e7eb;
    vertical-align: middle;
}
th{
    background:#2c3e50;
    color:#fff;
}
.status-issued{
    color:var(--danger);
    font-weight:bold;
}
.status-available{
    color:var(--secondary);
    font-weight:bold;
}
.top-section{
    display:grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap:20px;
    align-items: stretch;
}
.card{
    display:flex;
    flex-direction:column;
    justify-content:space-between;
    min-height:260px;
    transition: transform 0.3s, box-shadow 0.3s;
}
.card:hover{
    transform: translateY(-3px);
    box-shadow:0 12px 25px rgba(0,0,0,0.15);
}
.card h2{
    margin-bottom:15px;
    color:#1e293b;
}
.card input{
    width:90%;
    max-width:420px;
    padding:10px;
    font-size:14px;
    margin:10px auto;
}
.report-section{
    background:#ffffff;
    padding:25px;
    border-radius:12px;
    box-shadow:0 10px 25px rgba(0,0,0,0.08);
}
.report-cards{
    display:grid;
    grid-template-columns: repeat(auto-fit, minmax(200px,1fr));
    gap:20px;
}
.report-card{
    padding:20px;
    border-radius:12px;
    color:white;
    text-align:center;
    box-shadow:0 6px 15px rgba(0,0,0,0.1);
}
.report-card h3{
    margin-bottom:10px;
}
.report-card p{
    font-size:32px;
    font-weight:bold;
    margin:10px 0;
}
.report-card.total{ background:#6366f1; }
.report-card.issued{ background:#ef4444; }
.report-card.available{ background:#22c55e; }

table img{
    width:60px;
    height:80px;
    object-fit:cover;
    border-radius:6px;
    transition: transform 0.3s;
}
table img:hover{
    transform: scale(1.05);
}

@media(max-width:768px){
    .top-section, .report-cards{
        grid-template-columns:1fr;
    }
}
</style>
</head>
<body>
<h1>Smart Library Management System</h1>

<section class="top-section">
<div class="card">
<h2>‚ûï Add New Book</h2>
<input id="title" placeholder="Book Title">
<input id="author" placeholder="Author Name">
<input id="category" placeholder="Category">
<input id="image" placeholder="Book Image URL">
<button class="add-btn" onclick="addBook()">Add Book</button>
</div>

<div class="card">
<h2>üîç Search Books</h2>
<input id="search" placeholder="Search by Title, Author or Category">
<button class="search-btn" onclick="searchBook()">Search</button>
</div>
</section>

<section>
<h2>Book List</h2>
<table>
<thead>
<tr>
<th>Cover</th>
<th>Title</th>
<th>Author</th>
<th>Category</th>
<th>Status</th>
<th>Action</th>
</tr>
</thead>
<tbody id="booklist"></tbody>
</table>
</section>

<section class="report-section">
<h2>üìä Reports & Analytics</h2>
<div class="report-cards">
<div class="report-card total">
<h3>Total Books</h3>
<p id="totalBooks">--</p>
<button class="report-btn" onclick="generateReport()">Generate Report</button>
</div>
<div class="report-card issued">
<h3>Issued Books</h3>
<p id="issuedBooks">--</p>
<button class="analytics-btn">View Analytics</button>
</div>
<div class="report-card available">
<h3>Available Books</h3>
<p id="availableBooks">--</p>
<button class="analytics-btn">View Analytics</button>
</div>
</div>
</section>

<script>
// load books from localStorage
let books = JSON.parse(localStorage.getItem("books")) || [];

// Add Book
function addBook(){
    let title = document.getElementById("title").value.trim();
    let author = document.getElementById("author").value.trim();
    let category = document.getElementById("category").value.trim();
    let image = document.getElementById("image").value.trim();

    if(!title || !author || !category || !image){
        alert("Fill all fields including image");
        return;
    }

    books.push({title, author, category, image, issued:false, issueDate:null});
    localStorage.setItem("books", JSON.stringify(books));

    displayBooks(); // normal view after adding
    document.getElementById("title").value = "";
    document.getElementById("author").value = "";
    document.getElementById("category").value = "";
    document.getElementById("image").value = "";
}

// Display Books
function displayBooks(list = books, isSearch = false){
    let table = "";
    list.forEach((b, i) => {
        table += `
        <tr>
            <td>
                <img src="${b.image}" 
                     onerror="this.src='https://via.placeholder.com/60x80?text=No+Image'" 
                     style="width:60px;height:80px;object-fit:cover;border-radius:6px">
            </td>
            <td>${b.title}</td>
            <td>${b.author}</td>
            <td>${b.category}</td>
            <td class="${b.issued ? 'status-issued' : 'status-available'}">
                ${b.issued ? 'Issued' : 'Available'}
            </td>
            <td>
                ${isSearch 
                  ? '<span style="color:#64748b;font-weight:bold;">Search Mode</span>'
                  : `<button class="issue-btn" onclick="issueReturn(${i})">${b.issued?'Return':'Issue'}</button>
                     <button class="delete-btn" onclick="deleteBook(${i})">Delete</button>`}
            </td>
        </tr>
        `;
    });

    document.getElementById("booklist").innerHTML = table;

    if(!isSearch) generateReport(); // only update report in normal view
}

// Delete Book
function deleteBook(i){
    books.splice(i,1);
    localStorage.setItem("books", JSON.stringify(books));
    displayBooks();
}

// Issue / Return
function issueReturn(i){
    if(!books[i].issued){
        books[i].issued = true;
        books[i].issueDate = new Date();
        alert("Book Issued");
    } else {
        let issueDate = new Date(books[i].issueDate);
        let today = new Date();
        let days = Math.floor((today - issueDate)/(1000*60*60*24));
        let fine = days > 7 ? (days-7)*5 : 0;
        alert("Book Returned\nFine: "+fine+" Taka");
        books[i].issued = false;
        books[i].issueDate = null;
    }
    localStorage.setItem("books", JSON.stringify(books));
    displayBooks();
}

// Search Book
function searchBook(){
    let text = document.getElementById("search").value.trim().toLowerCase();
    if(text === ""){
        displayBooks(books, false); // back to normal view
        return;
    }
    let result = books.filter(b =>
        b.title.toLowerCase().includes(text) ||
        b.author.toLowerCase().includes(text) ||
        b.category.toLowerCase().includes(text)
    );
    displayBooks(result, true); // search mode
}

// Report
function generateReport(){
    let total = books.length;
    let issued = books.filter(b => b.issued).length;
    let available = total - issued;

    document.getElementById("totalBooks").innerText = total;
    document.getElementById("issuedBooks").innerText = issued;
    document.getElementById("availableBooks").innerText = available;
}

// Run on page load
displayBooks();
generateReport();
</script>
</body>
</html>